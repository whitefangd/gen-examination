service cloud.firestore {
  match /databases/{database}/documents {
    match /subjects/{document=**} {
      allow write: if get(/databases/$(database)/documents/users/$(request.auth.token.email)).data.role in ["SUPER", "ADMIN"];
      allow read: if request.auth.uid != null;
    }
  }
}